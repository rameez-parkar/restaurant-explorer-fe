!function(){"use strict";class e{constructor(e){this.cb=e}notify(e){this.cb(e)}}class t extends Error{constructor(e,t){super(e),this.message=e,this.originalError=t,this.name=this.constructor.name,t&&(this.stack+="\nCaused by: "+t.stack)}}class n extends t{constructor(e,t){super(e),this.message=e,this.metadata=t}}class i extends t{constructor(e,t){super(e),this.message=e,this.metadata=t}}class r extends t{}class o{constructor(e){this.queue=[],this.comparator=e?.comparator,this.maxSize=e?.maxSize}get size(){return this.queue.length}get isEmpty(){return 0===this.queue.length}add(...e){let t=[];return this.isAbleToFit(e.length)||(t=this.queue.splice(-e.length,this.queue.length-e.length)),this.queue.push(...e),this.prioritize(),{removedItems:t}}isAbleToFit(e){return void 0===this.maxSize||this.maxSize>=this.size+e}remove(e){const t=Math.min(this.queue.length,e);return this.queue.splice(0,t)}peek(){return this.queue[0]}prioritize(){this.comparator&&this.queue.sort(this.comparator)}}var a;!function(e){e.SERVICE="service",e.SERVICE_SUB_SECTION="serviceSubSection",e.SERVICE_CONSOLE_PAGE="serviceConsolePage",e.VARIANT="variant"}(a||(a={}));class s{constructor(e){this.window=e,this.isOnLoadListenerRegistered=!1,this.fallbackQueue=new o({maxSize:1e3})}readCommonAttribute(e){if(!this.isPanoramaAvailable())throw new r("Could not read attribute");const t=this.window?.panorama?.q?.trackerDictionary?.cf?.readCommonAttribute;return t&&"function"==typeof t?t()[e]:void 0}executeWhenPanoramaAvailable(e){this.isPanoramaAvailable()?e():this.enqueuePanoramaCall(e)}writeTelemetryMetric(e){this.executeWhenPanoramaAvailable((()=>this.window?.panorama("trackTelemetryMetrics",e)))}isPanoramaAvailable(){return void 0!==this.window&&"function"==typeof this.window?.panorama&&this.window?.panorama?.enabled}enqueuePanoramaCall(e){this.fallbackQueue.add(e),this.isOnLoadListenerRegistered||(this.window.addEventListener("onPanoramaLoad",(e=>{e.detail&&e.detail.enabled&&this.flushFallbackQueue()})),this.isOnLoadListenerRegistered=!0)}flushFallbackQueue(){this.fallbackQueue.remove(this.fallbackQueue.size).forEach((e=>e()))}}class c{constructor(e,t,n,i,r,o){this.window=e,this.telemetryToken=t,this.broker=n,this.panoramaMetricWriter=i,this.locationHandler=r,this.panoramaWrapper=o,this.isComponentReadyEmittedOnLoad=!1,this.locationChangeTime=this.now(),this.visitedCloudscapeMarkers=new Set,this.cutOffTimer=3e4,this.transitionCutOffTimer=15e3,this.eventsToListen=["keydown","click","pagehide"],this.iFrameConsoleList=["cw","ec2","vpc","vpcconsole"],this.tableEvents=["tableRendered","tableUpdated"],this.buttonEvents=["primaryButtonRendered","primaryButtonUpdated"],this.suppressDistractions=new Set(["Reload","Sign out","Abmelden","다시 로드","再ロード","Reset","Redefinir","サインアウト","Erneut laden","Enviar","Recharger","Recarregar","Réinitialiser","Volver a cargar","Muat ulang","Ricarica","Yeniden yükle","重新加载","重新載入","Cerrar sesión","Déconnexion","Keluar","Esci","로그아웃","Sair","Oturumu kapat","退出","登出"]),this.frameMetricNames={tableReadinessTransition:"frameTransitionTimeToTableReady",buttonReadinessTransition:"frameTransitionTimeToButtonReady",tableReadiness:"frameTimeToTableReady",buttonReadiness:"frameTimeToButtonReady"},this.tenantId=this.broker.register({telemetryToken:this.telemetryToken,source:"page-inline-script"}),this.emitComponentReadyMetric=this.emitComponentReadyMetric.bind(this),this.visiblityChangeHandler=this.visiblityChangeHandler.bind(this),this.setup()}now(){return"undefined"!=typeof performance&&"function"==typeof performance.now?performance.now():Date.now()}emitComponentReadyMetric(){try{if(this.window&&this.window.performance&&"function"==typeof this.window.performance.getEntriesByType){const t=this.window.performance.getEntriesByType("mark"),n=this.getActivationStart()||0,i=this.extractMetricToReport(t);if(i.length){let t=!1;i.forEach((e=>{if(e?.startTime&&e?.componentName){const{startTime:i,componentIdentifier:r,componentName:o}=e;let a="timeToTableReady",s=i-n;this.isComponentReadyEmittedOnLoad?(s=i-this.locationChangeTime,a="table"===o?"transitionTimeToTableReady":"transitionTimeToPrimaryButtonReady"):a="table"===o?"timeToTableReady":"timeToPrimaryButtonReady",s>0&&(this.panoramaMetricWriter.writeComponentReadyMetric({name:a,value:s,componentEventName:o,componentIdentifier:r}),this.broker.addEvent({tenantId:this.tenantId,event:{type:"component-ready",timestamp:new Date,version:"page_inline_script",content:{},componentReady:{name:a,value:s,metadata:{name:o,identifier:r}}}}),t=!0)}})),t&&(this.isComponentReadyEmittedOnLoad||this.locationHandler.addObserver(new e((e=>this.attachListenersOnLocationChange()))),this.isComponentReadyEmittedOnLoad=!0)}}}catch{}finally{this.removeListenersForComponentReady()}}canExecuteComponentReady(e){this.window.document.prerendering?this.window.addEventListener("prerenderingchange",(()=>e()),!0):e()}getActivationStart(){try{return this.window.performance&&this.window.performance.getEntriesByType&&this.window.performance.getEntriesByType("navigation")[0]&&this.window.performance.getEntriesByType("navigation")[0].activationStart||0}catch{return 0}}visiblityChangeHandler(){"hidden"===this.window.document.visibilityState&&this.emitComponentReadyMetric()}addListenersForComponentReady(){this.addOrRemoveListeners(!0)}removeListenersForComponentReady(){this.addOrRemoveListeners(!1)}addOrRemoveListeners(e=!0){e?(this.eventsToListen.forEach((e=>{this.window.addEventListener(e,this.emitComponentReadyMetric,!0)})),this.window.document.addEventListener("visibilitychange",this.visiblityChangeHandler),this.timerId=setTimeout((()=>this.emitComponentReadyMetric()),this.isComponentReadyEmittedOnLoad?this.transitionCutOffTimer:this.cutOffTimer)):(this.eventsToListen.forEach((e=>{this.window.removeEventListener(e,this.emitComponentReadyMetric,!0)})),this.window.document.removeEventListener("visibilitychange",this.visiblityChangeHandler),this.timerId&&clearTimeout(this.timerId))}attachListenersOnLocationChange(){this.locationChangeTime=this.now(),this.addListenersForComponentReady()}getNavigationStart(){return window.performance&&window.performance.timeOrigin?Math.round(performance.timeOrigin):window.performance.timing.navigationStart}getNavigationStartDelta(e){try{const t=e-this.getNavigationStart();return t>0?t:0}catch{return 0}}formattedFrameMetricName(e){const t=this.isComponentReadyEmittedOnLoad?`${e}Transition`:e;return this.frameMetricNames[t]}logFrameMetric(t){try{const{frameMetaData:{id:n="",name:i="",identifier:r="",navigationStart:o=this.getNavigationStart(),activationTime:a=0,src:s=""}={},metricList:c=[]}=t;let u=!1;c.length&&(c.forEach((e=>{const{startTime:t,name:c,componentStartTime:d=t,componentEventName:m="",componentIdentifier:h=""}=e;if(t&&["buttonReadiness","tableReadiness"].includes(c)){const e=this.formattedFrameMetricName(c);let l=t;l+=this.getNavigationStartDelta(o),this.isComponentReadyEmittedOnLoad?l-=this.locationChangeTime:l-=a,l>0&&(this.panoramaMetricWriter.writeFrameComponentReadyMetric({name:e,value:l,frameId:n,frameName:i,frameSrc:s,frameDuration:t,frameIdentifier:r,componentEventName:m,componentIdentifier:h,componentStartTime:d,navigationStart:o,locationChangeTime:this.locationChangeTime}),this.broker.addEvent({tenantId:this.tenantId,event:{type:"frame-component-ready",timestamp:new Date,version:"page_inline_script",content:{},frameComponentReady:{name:e,value:l,metadata:{name:i,id:n,src:s,duration:t,identifier:r,component:{name:m,identifier:h,startTime:d},navigationStart:o,locationChangeTime:this.locationChangeTime}}}}),u=!0)}})),u&&(this.isComponentReadyEmittedOnLoad||this.locationHandler.addObserver(new e((e=>this.attachListenersOnLocationChange()))),this.isComponentReadyEmittedOnLoad=!0))}catch(e){}}setupFrameMessageListeners(){addEventListener("message",(e=>{const{data:t}=e;"iFrame_Panorama_ConsoleLatency"===t?.event_id&&this.logFrameMetric(t)}))}setup(){if(this.window.performance){this.canExecuteComponentReady((()=>{this.addListenersForComponentReady()}));try{this.panoramaWrapper.executeWhenPanoramaAvailable((()=>{const e=this.panoramaWrapper.readCommonAttribute(a.SERVICE);e&&this.iFrameConsoleList.includes(e)&&this.setupFrameMessageListeners()}))}catch(e){}}}extractMetricToReport(e){const t=[];let n=null,i=null;for(let t=e.length-1;t>=0;t--){const{name:r,detail:o={}}=e[t],a=o?.text||o?.header||"",s=o?.instanceId||o?.instanceIdentifier;if("awsui"===o?.source&&!o?.loading&&s&&!this.visitedCloudscapeMarkers.has(s)&&!this.suppressDistractions.has(a)&&(this.visitedCloudscapeMarkers.add(s),this.tableEvents.includes(r)&&!i?i=e[t]:this.buttonEvents.includes(r)&&!n&&(n=e[t]),i&&n))break}return i&&t.push({componentName:"table",startTime:i.startTime,componentIdentifier:i.detail.text||i.detail.header||""}),n&&t.push({componentName:"primaryButton",startTime:n.startTime,componentIdentifier:n.detail.text||n.detail.header||""}),t}}class u{constructor(e,t,n){this.document=e,this.telemetryToken=t,this.broker=n,this.numberOfReportedEvents=0;const i=this.broker.register({telemetryToken:this.telemetryToken,source:"page-inline-script"});this.document.addEventListener("securitypolicyviolation",(t=>{++this.numberOfReportedEvents>10||this.broker.addEvent({tenantId:i,event:{type:"csp-violation",timestamp:new Date,version:"page_inline_script",content:{},cspViolation:{documentURI:t.documentURI||e.location.href,effectiveDirective:t.effectiveDirective||"unknown",originalPolicy:t.originalPolicy||"unknown",disposition:t.disposition||"enforce",statusCode:t.statusCode||200,blockedURI:t.blockedURI,sourceFile:t.sourceFile,sample:t.sample,lineNumber:t.lineNumber,columnNumber:t.columnNumber}}})}))}}function d(e){return`Bearer ${e}`}function m(e){return[e,"(broker: 1.0.1308.0#c94f4668)"].join(" ")}const h=new Map([["ap-southeast-6","ap-southeast-6.prod.tangerinebox.console.aws.a2z.com"],["us-isof-south-1","us-isof-south-1.prod.tangerinebox.console.a2z.hci.ic.gov"],["us-iso-west-1","us-iso-west-1.prod.tangerinebox.console.c2s-a2z.ic.gov"],["eu-north-1","eu-north-1.prod.tangerinebox.console.aws.a2z.com"],["me-south-1","me-south-1.prod.tangerinebox.console.aws.a2z.com"],["cn-north-1","cn-north-1.prod.tangerinebox.console.aws.a2z.org.cn"],["ap-southeast-7","ap-southeast-7.prod.tangerinebox.console.aws.a2z.com"],["ap-south-1","ap-south-1.prod.tangerinebox.console.aws.a2z.com"],["eu-west-3","eu-west-3.prod.tangerinebox.console.aws.a2z.com"],["ap-southeast-3","ap-southeast-3.prod.tangerinebox.console.aws.a2z.com"],["us-east-2","us-east-2.prod.tangerinebox.console.aws.a2z.com"],["af-south-1","af-south-1.prod.tangerinebox.console.aws.a2z.com"],["us-iso-east-1","us-iso-east-1.prod.tangerinebox.console.c2s-a2z.ic.gov"],["eu-west-1","eu-west-1.prod.tangerinebox.console.aws.a2z.com"],["me-central-1","me-central-1.prod.tangerinebox.console.aws.a2z.com"],["us-isob-west-1","us-isob-west-1.prod.tangerinebox.console.sc2s-a2z.sgov.gov"],["eu-central-1","eu-central-1.prod.tangerinebox.console.aws.a2z.com"],["sa-east-1","sa-east-1.prod.tangerinebox.console.aws.a2z.com"],["ap-east-1","ap-east-1.prod.tangerinebox.console.aws.a2z.com"],["ap-south-2","ap-south-2.prod.tangerinebox.console.aws.a2z.com"],["us-east-1","us-east-1.prod.tangerinebox.console.aws.a2z.com"],["ap-northeast-2","ap-northeast-2.prod.tangerinebox.console.aws.a2z.com"],["ap-northeast-3","ap-northeast-3.prod.tangerinebox.console.aws.a2z.com"],["ap-southeast-5","ap-southeast-5.prod.tangerinebox.console.aws.a2z.com"],["us-isob-east-1","us-isob-east-1.prod.tangerinebox.console.sc2s-a2z.sgov.gov"],["eu-west-2","eu-west-2.prod.tangerinebox.console.aws.a2z.com"],["us-isof-east-1","us-isof-east-1.prod.tangerinebox.console.a2z.hci.ic.gov"],["us-northeast-1","us-northeast-1.prod.tangerinebox.console.aws.a2z.com"],["ap-southeast-4","ap-southeast-4.prod.tangerinebox.console.aws.a2z.com"],["eu-south-1","eu-south-1.prod.tangerinebox.console.aws.a2z.com"],["eu-isoe-west-1","eu-isoe-west-1.prod.tangerinebox.console.a2z.adc-e.uk"],["ap-northeast-1","ap-northeast-1.prod.tangerinebox.console.aws.a2z.com"],["us-gov-east-1","us-gov-east-1.prod.tangerinebox.console.aws.a2z.com"],["us-gov-west-1","us-gov-west-1.prod.tangerinebox.console.aws.a2z.com"],["us-west-2","us-west-2.prod.tangerinebox.console.aws.a2z.com"],["mx-central-1","mx-central-1.prod.tangerinebox.console.aws.a2z.com"],["us-west-1","us-west-1.prod.tangerinebox.console.aws.a2z.com"],["ap-southeast-1","ap-southeast-1.prod.tangerinebox.console.aws.a2z.com"],["ap-southeast-2","ap-southeast-2.prod.tangerinebox.console.aws.a2z.com"],["eusc-de-east-1","eusc-de-east-1.prod.tangerinebox.console.aws.a2z.com"],["il-central-1","il-central-1.prod.tangerinebox.console.aws.a2z.com"],["ap-east-2","ap-east-2.prod.tangerinebox.console.aws.a2z.com"],["ca-central-1","ca-central-1.prod.tangerinebox.console.aws.a2z.com"],["ca-west-1","ca-west-1.prod.tangerinebox.console.aws.a2z.com"],["eu-south-2","eu-south-2.prod.tangerinebox.console.aws.a2z.com"],["cn-northwest-1","cn-northwest-1.prod.tangerinebox.console.aws.a2z.org.cn"],["eu-central-2","eu-central-2.prod.tangerinebox.console.aws.a2z.com"]]),l=["csp.hci.ic.gov","amazonaws.com.cn","c2s.ic.gov","amazonaws.com","sc2s.sgov.gov","cloud.adc-e.uk","amazonaws.com","amazonaws.eu"],p="aws-userInfo-signed";class f{constructor(){this.metaTagContentCache=this.parseTangerineBoxMetaTag()}static getInstance(){return this.metaDataProviderInstance||(this.metaDataProviderInstance=new f),this.metaDataProviderInstance}getMetaTagContent(){return this.metaTagContentCache}getTelemetryConfig(){const e=this.getTelemetryEndpoint();let t;const n=this.getSessionData()?.identityToken;if(n)t=d(n);else{if(!this.userInfoSignedCookieCache&&(this.userInfoSignedCookieCache=this.parseCookie(p),!this.userInfoSignedCookieCache))throw new Error(`No '${p}' cookie.`);t=d(this.userInfoSignedCookieCache)}return{endpoint:e,authHeader:t}}getSessionData(){return this.sessionDataCache||(this.sessionDataCache=this.parseSessionDataMetaTag()),this.sessionDataCache}getConsoleTelemetryToken(){const e=this.parseMetaTag("tbt-data");if(e)try{const t=JSON.parse(e).telemetryToken;return"string"==typeof t?t:void 0}catch(e){return}}getTelemetryEndpoint(){const e=this.getMetaTagContent(),t=e?.telemetry?.endpoint;if("string"==typeof t)return t;const n=Array.from(h.keys()),i=this.determineConsoleRegion(n);return`https://telemetry.cell-0.${h.get(i)}/telemetry`}determineConsoleRegion(e){const t=[()=>this.getSessionData()?.infrastructureRegion,()=>this.parseMetaTag("awsc-mezz-region"),()=>new URLSearchParams(window?.location?.search).get("region"),()=>{const e=window?.location?.hostname,t=e?.split(".")[0];return t}];for(const n of t){const t=n();if(t&&e.includes(t))return t}throw new Error("Cannot determine region for telemetry endpoint.")}getTrackerEventContext(){const e=this.getMetaTagContent();return{callerCategory:this.parseCookie("metrics-req-cat")||"customer",location:"undefined"!=typeof window?window.location.href:"nodejs",requestId:"undefined"!=typeof window&&this.parseMetaTag("awsc-proxy-request-id")||"unknown",nav2Enabled:Boolean(e?.nav2Enabled)}}parseTangerineBoxMetaTag(){const e=this.parseMetaTag("tb-data");if(e)try{return JSON.parse(e)}catch(e){return}}parseSessionDataMetaTag(){const e=this.parseMetaTag("awsc-session-data");if(e)try{return JSON.parse(e)}catch{return}}parseMetaTag(e){const t=document.querySelector(`meta[name='${e}']`);if(t)return t.content}parseCookie(e,t=document.cookie){const n=t.match(`${e}=([^;]*)`);if(n&&n[1])return n[1]}}class g{constructor(e,t,n){this.window=e,this.telemetryToken=t,this.broker=n;const i=this.broker.register({telemetryToken:this.telemetryToken,source:"page-inline-script"});this.window.addEventListener("error",(e=>{!e||this.isDOMEvent(e)||this.isExtensionError(e.filename)||this.isErrorToIgnore(e.message)||this.broker.addEvent({tenantId:i,event:{type:"unhandled-error",timestamp:new Date,version:"page_inline_script",content:this.buildTrackerEventContent(e)}})}),!0)}isDOMEvent(e){return"Event"===e.constructor?.name}isExtensionError(e){try{return!!e&&/eval|debugger|[a-zA-Z]*-extension/i.test(e)}catch(e){return!1}}isErrorToIgnore(e){try{return!!e&&g.ERRORS_TO_IGNORE.indexOf(e)>=0}catch(e){return!1}}buildTrackerEventContent(e){const t={};if(t.eventClass=e.constructor?.name??"unknown",e.detail){const n=JSON.stringify(e.detail);t.detail=n.slice(0,Math.min(n.length,g.MAX_EVENT_DETAIL_SIZE))}return e.message&&(t.message=e.message),e.filename&&(t.filename=e.filename),e.lineno&&(t.lineNumber=e.lineno),e.colno&&(t.columnNumber=e.colno),e.error&&e.error.stack&&(t.stack=e.error.stack),e.target&&e.target.tagName&&(t.tagName=e.target.tagName),t}}g.MAX_PAYLOAD_SIZE=65536,g.MAX_EVENT_DETAIL_SIZE=.75*g.MAX_PAYLOAD_SIZE,g.ERRORS_TO_IGNORE=["ResizeObserver loop limit exceeded","ResizeObserver loop completed with undelivered notifications.","Script error."];class v{constructor(e){this.window=e,this.observers=[],this.currentLocation=this.window.location.pathname+(this.window.location.hash||""),this.window.onpopstate?this.window.addEventListener("popstate",(()=>this.handle())):this.window.addEventListener("hashchange",(()=>this.handle()))}addObserver(e){this.observers.push(e)}handle(){const e=this.window.location.pathname+(this.window.location.hash||"");e!==this.currentLocation&&(this.observers.forEach((t=>t.notify({newLocation:e,oldLocation:this.currentLocation}))),this.currentLocation=e)}}const y={CLS:"cumulativeLayoutShift",FCP:"firstContentfulPaint",FID:"firstInputDelay",LCP:"largestContentfulPaint",TTFB:"timeToFirstByte",INP:"interactionToNextPaint"};class w{constructor(e){this.panoramaWrapper=e}writeLcp(e){let t="";e.entries.forEach((({startTime:n,element:i})=>{n===e.delta&&i&&(t=JSON.stringify({elementType:i.tagName,elementIdentifier:i.id,elementText:i.textContent?i.textContent.substring(0,50):""}))})),this.writeMetric({metricName:y[e.name],metricValue:e.value,metricUnit:"Milliseconds",metricDetails:t})}writeCls(e){this.writeMetric({metricName:y[e.name],metricValue:1e3*e.value,metricUnit:void 0,metricDetails:""})}writeInp(e){const t=[];e.entries.forEach((({entryType:e,duration:n,name:i,target:r})=>{t.push({entryType:e,duration:n,entryName:i,targetText:r?.textContent?r.textContent.substring(0,50):""})})),this.writeMetric({metricName:y[e.name],metricValue:e.value,metricUnit:"Milliseconds",metricDetails:JSON.stringify(t)})}writeGenericWebvitalMetric(e){this.writeMetric({metricName:y[e.name],metricValue:e.value,metricUnit:"Milliseconds",metricDetails:""})}writeComponentReadyMetric(e){this.writeMetric({metricName:e.name,metricValue:e.value,metricUnit:"Milliseconds",metricDetails:JSON.stringify({componentEventName:e.componentEventName,componentIdentifier:e.componentIdentifier})})}writeFrameComponentReadyMetric(e){this.writeMetric({metricName:e.name,metricValue:e.value,metricUnit:"Milliseconds",metricDetails:JSON.stringify({frameId:e.frameId,frameName:e.frameName,frameSrc:e.frameSrc,frameDuration:e.frameDuration,frameIdentifier:e.frameIdentifier,componentEventName:e.componentEventName,componentIdentifier:e.componentIdentifier,componentStartTime:e.componentStartTime,navigationStart:e.navigationStart,locationChangeTime:e.locationChangeTime})})}writeMetric(e){try{this.panoramaWrapper.writeTelemetryMetric({...e,timestamp:(new Date).getTime()})}catch{}}}var T,b,E,C,M,R=-1,S=function(e){addEventListener("pageshow",(function(t){t.persisted&&(R=t.timeStamp,e(t))}),!0)},k=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},I=function(){var e=k();return e&&e.activationStart||0},x=function(e,t){var n=k(),i="navigate";return R>=0?i="back-forward-cache":n&&(document.prerendering||I()>0?i="prerender":document.wasDiscarded?i="restore":n.type&&(i=n.type.replace(/_/g,"-"))),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:i}},L=function(e,t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var i=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return i.observe(Object.assign({type:e,buffered:!0},n||{})),i}}catch(e){}},P=function(e,t,n,i){var r,o;return function(a){t.value>=0&&(a||i)&&((o=t.value-(r||0))||void 0===r)&&(r=t.value,t.delta=o,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,n),e(t))}},z=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},N=function(e){var t=function(t){"pagehide"!==t.type&&"hidden"!==document.visibilityState||e(t)};addEventListener("visibilitychange",t,!0),addEventListener("pagehide",t,!0)},O=function(e){var t=!1;return function(n){t||(e(n),t=!0)}},D=-1,A=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},_=function(e){"hidden"===document.visibilityState&&D>-1&&(D="visibilitychange"===e.type?e.timeStamp:0,W())},F=function(){addEventListener("visibilitychange",_,!0),addEventListener("prerenderingchange",_,!0)},W=function(){removeEventListener("visibilitychange",_,!0),removeEventListener("prerenderingchange",_,!0)},q=function(){return D<0&&(D=A(),F(),S((function(){setTimeout((function(){D=A(),F()}),0)}))),{get firstHiddenTime(){return D}}},B=function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()},Q=[1800,3e3],U=function(e,t){t=t||{},B((function(){var n,i=q(),r=x("FCP"),o=L("paint",(function(e){e.forEach((function(e){"first-contentful-paint"===e.name&&(o.disconnect(),e.startTime<i.firstHiddenTime&&(r.value=Math.max(e.startTime-I(),0),r.entries.push(e),n(!0)))}))}));o&&(n=P(e,r,Q,t.reportAllChanges),S((function(i){r=x("FCP"),n=P(e,r,Q,t.reportAllChanges),z((function(){r.value=performance.now()-i.timeStamp,n(!0)}))})))}))},V=[.1,.25],H={passive:!0,capture:!0},j=new Date,J=function(e,t){T||(T=t,b=e,E=new Date,$(removeEventListener),G())},G=function(){if(b>=0&&b<E-j){var e={entryType:"first-input",name:T.type,target:T.target,cancelable:T.cancelable,startTime:T.timeStamp,processingStart:T.timeStamp+b};C.forEach((function(t){t(e)})),C=[]}},Y=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){J(e,t),r()},i=function(){r()},r=function(){removeEventListener("pointerup",n,H),removeEventListener("pointercancel",i,H)};addEventListener("pointerup",n,H),addEventListener("pointercancel",i,H)}(t,e):J(t,e)}},$=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,Y,H)}))},X=[100,300],Z=0,K=1/0,ee=0,te=function(e){e.forEach((function(e){e.interactionId&&(K=Math.min(K,e.interactionId),ee=Math.max(ee,e.interactionId),Z=ee?(ee-K)/7+1:0)}))},ne=function(){return M?Z:performance.interactionCount||0},ie=function(){"interactionCount"in performance||M||(M=L("event",te,{type:"event",buffered:!0,durationThreshold:0}))},re=[200,500],oe=0,ae=function(){return ne()-oe},se=[],ce={},ue=function(e){var t=se[se.length-1],n=ce[e.interactionId];if(n||se.length<10||e.duration>t.latency){if(n)n.entries.push(e),n.latency=Math.max(n.latency,e.duration);else{var i={id:e.interactionId,latency:e.duration,entries:[e]};ce[i.id]=i,se.push(i)}se.sort((function(e,t){return t.latency-e.latency})),se.splice(10).forEach((function(e){delete ce[e.id]}))}},de=[2500,4e3],me={},he=[800,1800],le=function e(t){document.prerendering?B((function(){return e(t)})):"complete"!==document.readyState?addEventListener("load",(function(){return e(t)}),!0):setTimeout(t,0)},pe=function(e,t){t=t||{};var n=x("TTFB"),i=P(e,n,he,t.reportAllChanges);le((function(){var r=k();if(r){var o=r.responseStart;if(o<=0||o>performance.now())return;n.value=Math.max(o-I(),0),n.entries=[r],i(!0),S((function(){n=x("TTFB",0),(i=P(e,n,he,t.reportAllChanges))(!0)}))}}))};class fe{constructor(t,n,i){this.telemetryToken=t,this.broker=n,this.panoramaMetricWriter=i,this.fallbackQueue=new o({maxSize:1e3}),this.isNewWebLibRegistered=!1,this.tenantId=this.broker.register({telemetryToken:this.telemetryToken,source:"page-inline-script"}),this.broker.addRegistrationObserver(new e((e=>this.flushFallbackQueue(e)))),this.emitWebVitalsMetrics(),this.emitPerformanceMetrics(["resource","navigation","measure"],(e=>this.processPerformanceMetrics(e)))}emitWebVitalsMetrics(){!function(e,t){t=t||{},U(O((function(){var n,i=x("CLS",0),r=0,o=[],a=function(e){e.forEach((function(e){if(!e.hadRecentInput){var t=o[0],n=o[o.length-1];r&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(r+=e.value,o.push(e)):(r=e.value,o=[e])}})),r>i.value&&(i.value=r,i.entries=o,n())},s=L("layout-shift",a);s&&(n=P(e,i,V,t.reportAllChanges),N((function(){a(s.takeRecords()),n(!0)})),S((function(){r=0,i=x("CLS",0),n=P(e,i,V,t.reportAllChanges),z((function(){return n()}))})),setTimeout(n,0))})))}((e=>{this.processWebVitalsMetrics(e),this.panoramaMetricWriter.writeCls(e)})),U((e=>{this.processWebVitalsMetrics(e),this.panoramaMetricWriter.writeGenericWebvitalMetric(e)})),function(e,t){t=t||{},B((function(){var n,i=q(),r=x("LCP"),o=function(e){var t=e[e.length-1];t&&t.startTime<i.firstHiddenTime&&(r.value=Math.max(t.startTime-I(),0),r.entries=[t],n())},a=L("largest-contentful-paint",o);if(a){n=P(e,r,de,t.reportAllChanges);var s=O((function(){me[r.id]||(o(a.takeRecords()),a.disconnect(),me[r.id]=!0,n(!0))}));["keydown","click"].forEach((function(e){addEventListener(e,(function(){return setTimeout(s,0)}),!0)})),N(s),S((function(i){r=x("LCP"),n=P(e,r,de,t.reportAllChanges),z((function(){r.value=performance.now()-i.timeStamp,me[r.id]=!0,n(!0)}))}))}}))}((e=>{this.processPageEvent(e),this.processWebVitalsMetrics(e),this.panoramaMetricWriter.writeLcp(e)})),function(e,t){t=t||{},B((function(){var n,i=q(),r=x("FID"),o=function(e){e.startTime<i.firstHiddenTime&&(r.value=e.processingStart-e.startTime,r.entries.push(e),n(!0))},a=function(e){e.forEach(o)},s=L("first-input",a);n=P(e,r,X,t.reportAllChanges),s&&N(O((function(){a(s.takeRecords()),s.disconnect()}))),s&&S((function(){var i;r=x("FID"),n=P(e,r,X,t.reportAllChanges),C=[],b=-1,T=null,$(addEventListener),i=o,C.push(i),G()}))}))}((e=>{this.processWebVitalsMetrics(e),this.panoramaMetricWriter.writeGenericWebvitalMetric(e)})),pe((e=>{this.processWebVitalsMetrics(e),this.panoramaMetricWriter.writeGenericWebvitalMetric(e)})),function(e,t){t=t||{},B((function(){var n;ie();var i,r=x("INP"),o=function(e){e.forEach((function(e){e.interactionId&&ue(e),"first-input"===e.entryType&&!se.some((function(t){return t.entries.some((function(t){return e.duration===t.duration&&e.startTime===t.startTime}))}))&&ue(e)}));var t,n=(t=Math.min(se.length-1,Math.floor(ae()/50)),se[t]);n&&n.latency!==r.value&&(r.value=n.latency,r.entries=n.entries,i())},a=L("event",o,{durationThreshold:null!==(n=t.durationThreshold)&&void 0!==n?n:40});i=P(e,r,re,t.reportAllChanges),a&&("interactionId"in PerformanceEventTiming.prototype&&a.observe({type:"first-input",buffered:!0}),N((function(){o(a.takeRecords()),r.value<0&&ae()>0&&(r.value=0,r.entries=[]),i(!0)})),S((function(){se=[],oe=ne(),r=x("INP"),i=P(e,r,re,t.reportAllChanges)})))}))}((e=>{this.processWebVitalsMetrics(e),this.panoramaMetricWriter.writeInp(e)}))}processWebVitalsMetrics(e){this.broker.addEvent({tenantId:this.tenantId,event:{type:"web-vitals-metric",timestamp:new Date,version:"page_inline_script",content:{},webVitalsMetric:{name:e.name,value:e.value}}})}emitPerformanceMetrics(e,t){if(window&&"PerformanceObserver"in window){const n=new PerformanceObserver(t);try{e.forEach((e=>n.observe({type:e,buffered:!0})))}catch{n.observe({entryTypes:e})}}}processCustomMeasureMetrics(e){e.name.length>0&&e.name.match("^[A-Za-z]")&&this.enqueue({tenantId:this.tenantId,event:{type:"custom-measure-metric",timestamp:new Date,version:"page_inline_script",content:{},customMeasureMetric:{name:e.name,timeToCustomMark:e.duration}}})}processNavigationMetrics(e){e.loadEventEnd&&this.enqueue({tenantId:this.tenantId,event:{type:"navigation-metric",timestamp:new Date,version:"page_inline_script",content:{},navigationMetric:{startTime:e.startTime,duration:e.duration,initiatorType:e.initiatorType,domComplete:e.domComplete,domContentLoadedEventEnd:e.domContentLoadedEventEnd,domContentLoadedEventStart:e.domContentLoadedEventStart,domInteractive:e.domInteractive,loadEventEnd:e.loadEventEnd,loadEventStart:e.loadEventStart,redirectCount:e.redirectCount,redirectStart:e.redirectStart,requestStart:e.requestStart,responseStart:e.responseStart,type:e.type,unloadEventEnd:e.unloadEventEnd,unloadEventStart:e.unloadEventStart}}})}processPageEvent(e){this.enqueue({tenantId:this.tenantId,event:{type:"page-metric",timestamp:new Date,version:"page_inline_script",content:{},pageMetric:{timeToLoadLargestContentfulPaint:e.value}}})}processResourceMetrics(e){e.name.includes("/p/log/")||e.name.includes("panoramaroute")||e.name.includes("telemetry")||e.name.startsWith("data:")||e.name.startsWith("blob:")||e.name.match(new RegExp(`^https://polly\\.[a-z0-9-]+\\.${l.map((e=>e.replace(/\./g,"\\."))).join("|")}/v1/speech\\?}`))||this.enqueue({tenantId:this.tenantId,event:{type:"resource-metric",timestamp:new Date,version:"page_inline_script",content:{},resourceMetric:{url:e.name,startTime:e.startTime,duration:e.duration,initiatorType:e.initiatorType,nextHopProtocol:e.nextHopProtocol,fetchStart:e.fetchStart,domainLookupStart:e.domainLookupStart,domainLookupEnd:e.domainLookupEnd,connectStart:e.connectStart,connectEnd:e.connectEnd,requestStart:e.requestStart,responseStart:e.responseStart,responseEnd:e.responseEnd,transferSize:e.transferSize,encodedBodySize:e.encodedBodySize,decodedBodySize:e.decodedBodySize}}})}isMeasureEntry(e){return"measure"===e.entryType}isNavigationEntry(e){return"navigation"===e.entryType}isResourceEntry(e){return"resource"===e.entryType}processPerformanceMetrics(e){for(const t of e.getEntries())this.isMeasureEntry(t)?this.processCustomMeasureMetrics(t):this.isNavigationEntry(t)?this.processNavigationMetrics(t):this.isResourceEntry(t)&&this.processResourceMetrics(t)}enqueue(e){this.isNewWebLibRegistered?this.broker.addEvent(e):this.fallbackQueue.add(e)}flushFallbackQueue(e){if(!this.isNewWebLibRegistered&&this.telemetryToken===e.telemetryToken&&("weblib-v1"===e.source||"weblib-v2"===e.source)){this.fallbackQueue.remove(this.fallbackQueue.size).forEach((e=>this.broker.addEvent(e))),this.isNewWebLibRegistered=!0}}}class ge{constructor(e){this.jsonReplacer=e}async call(e){const t=new Date;for(let r=0;r<=(e.maxRetries??4);r++)try{const n=await this.callWithFetch(e,r);if(!((i=n.status)>=500||429===i))return{finalHttpStatusCode:n.status,data:n.data,retries:r,startTimestamp:t,latencyMillseconds:(new Date).getTime()-t.getTime(),maxRetriesExceeded:!1}}catch(i){if(r>=(e.maxRetries??4)&&i instanceof Error)throw new n(i.message,{finalHttpStatusCode:500,retries:r,code:i.metadata.code,startTimestamp:t,latencyMillseconds:(new Date).getTime()-t.getTime(),maxRetriesExceeded:!0})}var i;throw new n("Too many retries",{finalHttpStatusCode:500,retries:e.maxRetries??4,startTimestamp:t,code:"MaxRetriesExceeded",latencyMillseconds:(new Date).getTime()-t.getTime(),maxRetriesExceeded:!0})}async callWithFetch(e,t){const n={method:e.method,headers:{"X-Retries":`${t}`,...e.headers},keepalive:e.keepalive??!1};if(void 0!==e.timeout&&e.timeout>0){const i=new AbortController;setTimeout((()=>i.abort()),e.timeout+t*(e.timeoutIncreasePerRetry||0)),n.signal=i.signal}"GET"!==e.method.toUpperCase()&&(n.body=this.createBody(e));try{const i=await fetch(e.url,n),r=i?.headers?.get("Content-Type");if(r&&/application\/json/.test(r)){return{data:await i.json(),retries:t,status:i.status}}return{data:await i.text(),retries:t,status:i.status}}catch(e){throw e instanceof Error&&"AbortError"===e.name?new i("Request timeout",{code:"RequestTimeout",finalHttpStatusCode:500,retries:t}):new i("Request encountered an error",{code:"RequestFailed",finalHttpStatusCode:500,retries:t})}}createBody(e){const t=e.data;return t?"string"==typeof t?t:"object"==typeof t?JSON.stringify(t,this.jsonReplacer):String(t):null}}class ve{constructor(){this.tenantThrottledEvents=new Map}registerThrottledEvent(e,t,n){const i=!0===n?.dryrun?"DRYRUN":void 0;this.tenantThrottledEvents.has(e)||this.tenantThrottledEvents.set(e,[]);const r=this.tenantThrottledEvents.get(e),o=r.find((e=>e.reason===i&&e.location===t.location&&e.subSection===t.subSection&&e.page===t.page));void 0!==o?o.count+=1:r.push({reason:i,count:1,location:t.location,subSection:t.subSection,page:t.page})}getTelemetryMonitoringAndReset(e){if(e<=0)return[];const t=Array.from(this.tenantThrottledEvents.entries()).slice(0,e);return t.forEach((([e])=>this.tenantThrottledEvents.delete(e))),t.map((([e,t])=>({telemetryToken:e,telemetryMonitoring:{throttledEvents:t}})))}}function ye(e,t){return e.timestamp===t.timestamp?0:e.timestamp<t.timestamp?-1:1}class we{constructor(e,t,n){this.dataParser=t,this.panoramaWrapper=n,this.httpClient=new ge(we.errorReplacer),this.tenantQueueMap=new Map,this.tenantDryrunQueueMap=new Map,this.telemetryMonitor=new ve,this.tenantQueueToStartRemoving=void 0,this.endpoint=e.endpoint,this.authorizationHeader=e.authorizationHeader,this.maxEventsInChunk=e?.maxEventsInChunk??100,this.maxPayloadSizePerChunk=e?.maxPayloadSizePerChunk??524288,this.maxQueueSize=e?.maxQueueSize??1e4}getOrCreateQueueForTenant(e){const t=this.tenantQueueMap.get(e);if(void 0===t){const t=new o({comparator:(e,t)=>function(e,t){return"error"===e.type&&"error"===t.type?ye(e,t):"error"===e.type?-1:"error"===t.type?1:ye(e,t)}(e.event,t.event),maxSize:this.maxQueueSize});return this.tenantQueueMap.set(e,t),this.tenantDryrunQueueMap.set(e,0),t}return t}get queueSize(){return Array.from(this.tenantQueueMap.values()).map((e=>e.size)).reduce(((e,t)=>e+t))}hasEvents(){return Array.from(this.tenantQueueMap.values()).some((e=>!e.isEmpty))}addEventContext(e){let t={...e,...this.dataParser.getTrackerEventContext()};try{t=this.addPageInformation(t)}catch(e){}return t}addEvent(e,t,n){const i=this.addEventContext(t),r=this.getOrCreateQueueForTenant(e),{removedItems:o}=r.add({event:i,telemetryTokens:n});o.forEach((e=>{const t=e.telemetryTokens[0];this.telemetryMonitor.registerThrottledEvent(t,e.event)}));const a=this.tenantDryrunQueueMap.get(e);if(a>=1e3){const e=n[0];this.telemetryMonitor.registerThrottledEvent(e,{location:"n/a"},{dryrun:!0})}else this.tenantDryrunQueueMap.set(e,a+1)}publish(e,t,n=!1,i=!1){const{events:r,tokens:o}=this.getEventsToPublish(this.maxEventsInChunk,n?65536:this.maxPayloadSizePerChunk);if(0===r.length)e();else{const a={events:r,tokens:o};this.sendChunk(a,e,t,n,i)}}getEventsToPublish(e,t){const n=Math.floor(e/2),{tokens:i,events:r}=this.getTelemetryMonitoringEventsToPublish(n),o=Array.from(this.tenantQueueMap.entries());if(void 0!==this.tenantQueueToStartRemoving){const e=o.findIndex((([e])=>e===this.tenantQueueToStartRemoving));o.push(...o.splice(0,e))}let a;for(;o.length>0;){const[n,s]=o.shift();if(r.length===e){a=a??n;break}if(s.isEmpty)continue;const{event:c,telemetryTokens:u}=s.peek(),d=i.length,m={...c,tokenRefs:u.map((e=>{const t=i.findIndex((t=>t===e));return-1===t?(i.push(e),i.length-1):t}))};if(0===r.length||JSON.stringify({events:r.concat(m)}).length<=t){r.push(m),s.remove(1),o.push([n,s]);const e=this.tenantDryrunQueueMap.get(n);e>0&&this.tenantDryrunQueueMap.set(n,e-1)}else a=a??n,i.splice(d)}return this.tenantQueueToStartRemoving=a,{events:r,tokens:i}}getTelemetryMonitoringEventsToPublish(e){const t=this.telemetryMonitor.getTelemetryMonitoringAndReset(e),n=t.map((({telemetryToken:e})=>e)),i=t.map((({telemetryToken:e,telemetryMonitoring:t})=>({type:"telemetry-monitoring",timestamp:new Date,version:m("page_inline_script"),content:{},telemetryMonitoring:t,...this.dataParser.getTrackerEventContext(),location:"various",tokenRefs:[n.findIndex((t=>t===e))]})));return{tokens:n,events:i}}flush(e){this.hasEvents()&&this.publish((()=>this.flush(e)),(()=>this.flush(e)),!0,e.initiatedByBeforeUnload?"beforeunload-flushed":"dangerously-flushed")}sendChunk(e,t,n,i=!1,r){const o=(()=>{switch(r){case!1:return"scheduled";case"beforeunload-flushed":return"flushed";default:return r}})(),a={timeout:3e4,method:"POST",headers:{Authorization:this.authorizationHeader,"Content-Type":"application/json","X-Remaining-Events":this.queueSize.toString(),"X-Publish-Type":o},url:this.endpoint,data:e,keepalive:i};this.httpClient.call(a).then(t).catch(n)}static errorReplacer(e,t){if(t instanceof Error){const e={};return Object.getOwnPropertyNames(t).forEach((n=>{e[n]=t[n]})),t.stack&&(e.stack=t.stack),e}if(t instanceof ErrorEvent){const e={};return t.message&&(e.message=t.message),t.filename&&(e.filename=t.filename),t.lineno&&(e.lineNumber=t.lineno),t.colno&&(e.columnNumber=t.colno),t.error&&t.error.stack&&(e.stack=t.error.stack),e}return t}addPageInformation(e){return{...e,subSection:this.panoramaWrapper.readCommonAttribute(a.SERVICE_SUB_SECTION)||void 0,page:this.panoramaWrapper.readCommonAttribute(a.SERVICE_CONSOLE_PAGE)||void 0}}}class Te{constructor(t,n,i){this.eventPublisher=t,this.tenantRegister=n,this.consoleTelemetryToken=i,this.scheduledInvocation=null,this.scheduledInvocationTime=0,this.isPublishing=!1,this.isListenerRegistered=!1,this.tenantRegister.addObserver(new e((e=>this.addUnloadListener(e)))),this.scheduleWithNextTick()}schedule(e=2e3){if(this.isPublishing)return;if(this.scheduledInvocation){if(this.scheduledInvocationTime<this.now()+e)return;clearTimeout(this.scheduledInvocation),this.scheduledInvocation=null}this.scheduledInvocation=setTimeout((()=>{this.isPublishing=!0,this.scheduledInvocation=null,this.eventPublisher.publish((()=>{this.isPublishing=!1,this.eventPublisher.hasEvents()?this.scheduleSubsequent():this.scheduleWithNextTick()}),(()=>{this.isPublishing=!1,this.scheduleWithNextTick()}))}),e),this.scheduledInvocationTime=this.now()+e}scheduleWithNextTick(){this.schedule(2e3)}scheduleSubsequent(){this.schedule(500)}scheduleError(){this.schedule(1e3)}now(){return"undefined"!=typeof performance&&"function"==typeof performance.now?performance.now():Date.now()}addUnloadListener(e){this.isListenerRegistered||e.telemetryToken!==this.consoleTelemetryToken||"weblib-v1"!==e.source&&"weblib-v2"!==e.source||"undefined"!=typeof window&&(window.addEventListener("beforeunload",(()=>this.eventPublisher.flush({initiatedByBeforeUnload:!0}))),this.isListenerRegistered=!0)}}class be{constructor(){this.idToPropsMap=new Map,this.propsToIdMap=new Map,this.observers=[]}set(e,t){const n=this.copyAndTransformRegisterProps(t);this.idToPropsMap.set(e,n),this.propsToIdMap.set(this.serialize(n),e),this.observers.forEach((e=>e.notify(n)))}hasTenantId(e){return this.idToPropsMap.has(e)}getProps(e){return this.idToPropsMap.get(e)}getTenantId(e){const t=this.serialize(this.copyAndTransformRegisterProps(e));return this.propsToIdMap.get(t)}addObserver(e){this.observers.push(e)}serialize(e){const t=e.telemetryTokensForPublicEvents?.length?[...e.telemetryTokensForPublicEvents].sort().join(","):void 0;return JSON.stringify({t:e.telemetryToken,t4p:t,s:e.source})}copyAndTransformRegisterProps(e){const t=e.telemetryTokensForPublicEvents?[...e.telemetryTokensForPublicEvents]:e.parentTelemetryToken?[e.parentTelemetryToken]:void 0;return{telemetryToken:e.telemetryToken,telemetryTokensForPublicEvents:t,source:e.source}}}let Ee;const Ce=new Uint8Array(16);function Me(){if(!Ee&&(Ee="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Ee))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ee(Ce)}const Re=[];for(let e=0;e<256;++e)Re.push((e+256).toString(16).slice(1));var Se={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function ke(e,t,n){if(Se.randomUUID&&!t&&!e)return Se.randomUUID();const i=(e=e||{}).random||(e.rng||Me)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=i[e];return t}return function(e,t=0){return Re[e[t+0]]+Re[e[t+1]]+Re[e[t+2]]+Re[e[t+3]]+"-"+Re[e[t+4]]+Re[e[t+5]]+"-"+Re[e[t+6]]+Re[e[t+7]]+"-"+Re[e[t+8]]+Re[e[t+9]]+"-"+Re[e[t+10]]+Re[e[t+11]]+Re[e[t+12]]+Re[e[t+13]]+Re[e[t+14]]+Re[e[t+15]]}(i)}class Ie{constructor(e){this.panoramaWrapper=e,this.tenantRegister=new be;const t=f.getInstance().getTelemetryConfig();this.eventPublisher=new we({endpoint:t.endpoint,authorizationHeader:t.authHeader},f.getInstance(),this.panoramaWrapper),this.requestScheduler=new Te(this.eventPublisher,this.tenantRegister,f.getInstance().getConsoleTelemetryToken())}register(e){const t=this.tenantRegister.getTenantId(e);if(void 0!==t)return t;let n;do{n=ke().split("-")[0]}while(this.tenantRegister.hasTenantId(n));return this.tenantRegister.set(n,e),n}addEvent(e){const t=this.tenantRegister.getProps(e.tenantId);if(void 0===t)return;const n=[t.telemetryToken];e.publicEvent&&void 0!==t.telemetryTokensForPublicEvents&&n.push(...t.telemetryTokensForPublicEvents),e.event.version=m(e.event.version),this.eventPublisher.addEvent(e.tenantId,e.event,n),"error"===e.event.type&&this.requestScheduler.scheduleError()}dangerouslyFlushEvents(){this.eventPublisher.flush({initiatedByBeforeUnload:!1})}addRegistrationObserver(e){this.tenantRegister.addObserver(e)}}var xe={};Object.defineProperty(xe,"__esModule",{value:!0});var Le=xe.TELEMETRY_BROKER_PROPERTY_NAME=void 0;Le=xe.TELEMETRY_BROKER_PROPERTY_NAME="_internal_tb_telemetry_broker";const Pe=f.getInstance().getConsoleTelemetryToken();if("undefined"!=typeof window){const e=new s(window),t=new Ie(e),n=new w(e);Pe&&(new u(window.document,Pe,t),new g(window,Pe,t),new fe(Pe,t,n),new c(window,Pe,t,n,new v(window),e)),window[Le]=t}}();
//# sourceMappingURL=index.js.map
